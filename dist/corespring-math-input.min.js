/*! corespring-math-input - v0.0.1 - 2015-12-23
* Copyright (c) 2015 CoreSpring; Licensed MIT */
angular.module("corespring.math-input",[]),angular.module("corespring.math-input").factory("MathInputController",[function(){return function(){return function(a){}}}]),angular.module("corespring.math-input").factory("KeypadDef",["MathInputConfig","$log","$compile",function(a,b,c){function d(b,d){this.link=function(d,e,f,g){function h(){d.onClick=function(a){_.isFunction(d.onClickCallback)&&d.onClickCallback({action:a})}}function i(){var a=$(b()),f=$(a);e.html(f),c(f)(d),h()}(new a).postLink(d),i()}}b.debug.bind(b,"[new-keypad-def]");return d}]),angular.module("corespring.math-input").directive("keypad",["KeypadDef",function(a){function b(){return['<div class="keypad" ng-class="keypadType">','  <div class="{{ sections[section].code }}-section" ng-repeat="section in types[keypadType].sections">','    <button ng-repeat="button in sections[section].buttons" ','            id="{{button}}-button"','            class="button {{buttons[button].cssClass}}"','            title="{{buttons[button].name}}"','            ng-click="onClick(button)">',"            {{buttons[button].symbol}}</button>","  </div>","</div>"].join("\n")}var c=new a(b);return{restrict:"E",link:c.link,replace:!0,scope:{keypadType:"=",showKeypad:"=",onClickCallback:"&"}}}]),angular.module("corespring.math-input").factory("MathInputConfig",[function(){function a(){this.postLink=function(a){a.types=e,a.sections=d,a.buttons=c,a.angularUnits=b}}var b={};b.DEGREES="degrees",b.RADIANS="radians";var c={};c.left={id:"left",name:"Move left",symbol:"l",logic:"cursor",comamnd:"",cssClass:"cursor"},c.right={id:"right",name:"Move right",symbol:"r",logic:"cursor",comamnd:"",cssClass:"cursor"},c.up={id:"up",name:"Move up",symbol:"u",logic:"cursor",comamnd:"",cssClass:"cursor"},c.down={id:"down",name:"Move down",symbol:"d",logic:"cursor",comamnd:"",cssClass:"cursor"},c.backspace={id:"left",name:"Move left",symbol:"b",logic:"cursor",comamnd:"",cssClass:"cursor"},c.one={id:"one",name:"One",symbol:"1",logic:"cmd",comamnd:"",cssClass:"number"},c.two={id:"two",name:"Two",symbol:"2",logic:"cmd",comamnd:"",cssClass:"number"},c.three={id:"three",name:"Three",symbol:"3",logic:"cmd",comamnd:"",cssClass:"number"},c.four={id:"four",name:"Four",symbol:"4",logic:"cmd",comamnd:"",cssClass:"number"},c.five={id:"five",name:"Five",symbol:"5",logic:"cmd",comamnd:"",cssClass:"number"},c.six={id:"six",name:"Six",symbol:"6",logic:"cmd",comamnd:"",cssClass:"number"},c.seven={id:"seven",name:"Seven",symbol:"7",logic:"cmd",comamnd:"",cssClass:"number"},c.eight={id:"eight",name:"Eight",symbol:"8",logic:"cmd",comamnd:"",cssClass:"number"},c.nine={id:"nine",name:"Nine",symbol:"9",logic:"cmd",comamnd:"",cssClass:"number"},c.zero={id:"zero",name:"Zero",symbol:"0",logic:"cmd",comamnd:"",cssClass:"number"},c.decimal={id:"decimal",name:"Decimal point",symbol:".",logic:"cmd",comamnd:"",cssClass:"number"},c.equals={id:"equals",name:"Equals",symbol:"=",logic:"cmd",comamnd:"",cssClass:"number"};var d={};d.cursor={name:"Move cursor area",buttons:["left","right","up","down","backspace"],code:"cursor"},d.numeric={name:"Numeric area",buttons:["seven","eight","nine","four","five","six","one","two","three","zero","decimal","equals"],code:"numeric"};var e={};return e.basic={name:"Basic",sections:["cursor","numeric"]},a}]),angular.module("corespring.math-input").factory("MathInputDef",["MathInputConfig","$log","$compile","$document",function(a,b,c,d){function e(b,e){this.link=function(e,g,h){function i(a,c){var d=$(b()),g=$(d);return e.instanceId=Math.random().toString(36).substring(7),g.attr("id",e.instanceId),f("Instance ID: "+e.instanceId),g}function j(){function a(a){e.focusedInput.mathquill("cursor",a)}function b(a){e.focusedInput.mathquill("cmd",a)}g.on("focus",".mathquill-editable",function(a){e.showKeypad===!1&&d.mousedown(),e.showKeypad=!0,e.focusedInput=$(this),e.$apply(function(){d.on("mousedown",function(a){e.$apply(function(){$.contains(d[0].getElementById(e.instanceId),a.target)||(e.showKeypad=!1,d.off("mousedown"))})})})}),e.clickButton=function(c){var d=e.buttons[c];switch(f("Clicked button: "+c),d.logic){case"cursor":a(c);break;case"cmd":b(d.symbol);break;default:f("Not supported: "+c)}}}function k(){f("Math input init..."),e.showKeypad=!1,e.focusedInput=null;var a=i(g,h);g.html(a),c(a)(e),j()}(new a).postLink(e),k()}}var f=b.debug.bind(b,"[math-input-def]");return e}]),angular.module("corespring.math-input").directive("mathInput",["MathInputController","MathInputDef",function(a,b){function c(){return['<div class="math-input">','  <div class="input" ng-class="{ \'dotted\': dotted }">',"    <span ng-class=\"editable ? 'mathquill-editable' : 'mathquill-embedded-latex'\">{{expression}}</span>","  </div>",'  <keypad ng-show="showKeypad" keypad-type="keypadType" show-keypad="showKeypad" on-click-callback="clickButton(action)"></keypad>',"</div>"].join("\n")}var d=new b(c);return{restrict:"E",link:d.link,replace:!0,scope:{expression:"=",editable:"=",dotted:"=",keypadType:"="}}}]);