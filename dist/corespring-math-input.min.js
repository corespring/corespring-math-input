/*! corespring-math-input - v0.0.1 - 2015-12-23
* Copyright (c) 2015 CoreSpring; Licensed MIT */
angular.module("corespring.math-input",[]),angular.module("corespring.math-input").factory("MathInputController",[function(){return function(){return function(a){}}}]),angular.module("corespring.math-input").factory("KeypadDef",["MathInputConfig","$log","$compile",function(a,b,c){function d(b,d){this.link=function(d,e,f,g){function h(){d.onClick=function(a){_.isFunction(d.onClickCallback)&&d.onClickCallback({action:a})}}function i(){var a=$(b()),f=$(a);e.html(f),c(f)(d),h()}(new a).postLink(d),i()}}b.debug.bind(b,"[new-keypad-def]");return d}]),angular.module("corespring.math-input").directive("keypad",["KeypadDef",function(a){function b(){return['<div class="keypad" ng-class="keypadType">','  <div class="{{ sections[section].code }}-section" ng-repeat="section in types[keypadType].sections">','    <button ng-repeat="button in sections[section].buttons" ','            id="{{button}}-button"','            class="button {{buttons[button].cssClass}}"','            title="{{buttons[button].name}}"','            ng-click="onClick(button)">','            <div ng-bind-html="buttons[button].symbol"></div></button>',"  </div>","</div>"].join("\n")}var c=new a(b);return{restrict:"E",link:c.link,replace:!0,scope:{keypadType:"=",showKeypad:"=",onClickCallback:"&"}}}]),angular.module("corespring.math-input").factory("MathInputConfig",["$sce",function(a){function b(){this.postLink=function(a){a.types=f,a.sections=e,a.buttons=d,a.angularUnits=c}}var c={};c.DEGREES="degrees",c.RADIANS="radians";var d={};d.left={id:"left",name:"Move left",symbol:a.trustAsHtml("&larr;"),logic:"cursor",command:"left",shortcut:"",cssClass:"cursor"},d.right={id:"right",name:"Move right",symbol:a.trustAsHtml("&rarr;"),logic:"cursor",command:"right",shortcut:"",cssClass:"cursor"},d.up={id:"up",name:"Move up",symbol:a.trustAsHtml("&uarr;"),logic:"cursor",command:"",shortcut:"up",cssClass:"cursor"},d.down={id:"down",name:"Move down",symbol:a.trustAsHtml("&darr;"),logic:"cursor",command:"down",shortcut:"",cssClass:"cursor"},d.backspace={id:"backspace",name:"Backspace",symbol:a.trustAsHtml("&LeftArrowBar;"),logic:"cursor",command:"backspace",shortcut:"",cssClass:"cursor"},d.one={id:"one",name:"One",symbol:a.trustAsHtml("1"),logic:"cmd",command:"1",shortcut:"",cssClass:"number"},d.two={id:"two",name:"Two",symbol:a.trustAsHtml("2"),logic:"cmd",command:"2",shortcut:"",cssClass:"number"},d.three={id:"three",name:"Three",symbol:a.trustAsHtml("3"),logic:"cmd",command:"3",shortcut:"",cssClass:"number"},d.four={id:"four",name:"Four",symbol:a.trustAsHtml("4"),logic:"cmd",command:"4",shortcut:"",cssClass:"number"},d.five={id:"five",name:"Five",symbol:a.trustAsHtml("5"),logic:"cmd",command:"5",shortcut:"",cssClass:"number"},d.six={id:"six",name:"Six",symbol:a.trustAsHtml("6"),logic:"cmd",command:"6",shortcut:"",cssClass:"number"},d.seven={id:"seven",name:"Seven",symbol:a.trustAsHtml("7"),logic:"cmd",command:"7",shortcut:"",cssClass:"number"},d.eight={id:"eight",name:"Eight",symbol:a.trustAsHtml("8"),logic:"cmd",command:"8",shortcut:"",cssClass:"number"},d.nine={id:"nine",name:"Nine",symbol:a.trustAsHtml("9"),logic:"cmd",command:"9",shortcut:"",cssClass:"number"},d.zero={id:"zero",name:"Zero",symbol:a.trustAsHtml("0"),logic:"cmd",command:"0",shortcut:"",cssClass:"number"},d.decimal={id:"decimal",name:"Decimal point",symbol:a.trustAsHtml("."),logic:"cmd",command:".",shortcut:"",cssClass:"number"},d.equals={id:"equals",name:"Equals",symbol:a.trustAsHtml("="),logic:"cmd",command:"=",shortcut:"",cssClass:"number"},d.plus={id:"plus",name:"Plus",symbol:a.trustAsHtml("+"),logic:"cmd",command:"+",shortcut:"",cssClass:"basic-operation"},d.minus={id:"minus",name:"Minus",symbol:a.trustAsHtml("-"),logic:"cmd",command:"-",shortcut:"",cssClass:"basic-operation"},d.multiply={id:"multiply",name:"Multiply",symbol:a.trustAsHtml("x"),logic:"cmd",command:"\\times",shortcut:"",cssClass:"basic-operation"},d.divide={id:"divide",name:"Divide",symbol:a.trustAsHtml("&#247"),logic:"cmd",command:"\\div",shortcut:"",cssClass:"basic-operation"};var e={};e.cursor={name:"Move cursor section",buttons:["left","right","up","down","backspace"],code:"cursor"},e.numeric={name:"Numeric section",buttons:["seven","eight","nine","four","five","six","one","two","three","zero","decimal","equals"],code:"numeric"},e.basic={name:"Basic functions section",buttons:["plus","minus","multiply","divide"],code:"basic"};var f={};return f.basic={name:"Basic",sections:["cursor","numeric","basic"]},b}]),angular.module("corespring.math-input").factory("MathInputDef",["MathInputConfig","$log","$compile","$document",function(a,b,c,d){function e(b,e){this.link=function(e,g,h){function i(a,c){var d=$(b()),g=$(d);return e.instanceId=Math.random().toString(36).substring(7),g.attr("id",e.instanceId),f("Instance ID: "+e.instanceId),g}function j(){g.on("focus",".mathquill-editable",function(a){e.showKeypad===!1&&d.mousedown(),e.showKeypad=!0,e.focusedInput=$(this),e.$apply(function(){d.on("mousedown",function(a){e.$apply(function(){$.contains(d[0].getElementById(e.instanceId),a.target)||(e.showKeypad=!1,d.off("mousedown"))})})})}),e.clickButton=function(a){var b=e.buttons[a];f("Clicked button: "+a),"cursor"===b.logic||"cmd"===b.logic?e.focusedInput.mathquill(b.logic,b.command):f("Not supported. [ Logic: "+b.logic+", Action: "+a+"]")}}function k(){f("Math input init..."),e.showKeypad=!1,e.focusedInput=null;var a=i(g,h);g.html(a),c(a)(e),j()}(new a).postLink(e),k()}}var f=b.debug.bind(b,"[math-input-def]");return e}]),angular.module("corespring.math-input").directive("mathInput",["MathInputController","MathInputDef",function(a,b){function c(){return['<div class="math-input">','  <div class="input" ng-class="{ \'dotted\': dotted }">',"    <span ng-class=\"editable ? 'mathquill-editable' : 'mathquill-embedded-latex'\">{{expression}}</span>","  </div>",'  <keypad ng-show="showKeypad" keypad-type="keypadType" show-keypad="showKeypad" on-click-callback="clickButton(action)"></keypad>',"</div>"].join("\n")}var d=new b(c);return{restrict:"E",link:d.link,replace:!0,scope:{expression:"=",editable:"=",dotted:"=",keypadType:"="}}}]);